onsuccess: next_stage
debug: true
name: haileyxb/freeswitch
description: "Parse Freeswitch logs"
filter: evt.Parsed.program == 'freeswitch'
pattern_syntax:
  FS_TIMESTAMP: '202[12]-[01][0-9]-[01]\d \d\d:\d\d:\d\d.\d+'
  FS_EXTENSION: '\[[0-9a-zA-Z]+@107.170.213.226\]'
grok:
  pattern: ^%{FS_TIMESTAMP:timestamp} \[WARNING\]sofia_reg.c:1739 SIP auth failure (REGISTER) on sofia profile 'internal' for %{FS_EXTENSION:fs_exten} from ip %{IP:source_ip}$
  apply_on: message
statics:
  - meta: log_type
    value: freeswitch_failed_auth
  - meta: source_ip
    expression: "evt.Parsed.source_ip"
  - meta: exten
    expression: "evt.Parsed.fs_exten"
